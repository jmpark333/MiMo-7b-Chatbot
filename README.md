# MiMo-7B-Chatbot Streamlit Interface

이 프로젝트는 로컬에서 실행되는 LM Studio의 `mimo-7b-rl` 모델과 상호작용하는 간단한 Streamlit 기반 챗봇 인터페이스입니다.

## 주요 기능

*   **Streamlit 기반 UI:** 사용자와 챗봇 간의 대화를 위한 웹 인터페이스를 제공합니다.
*   **LM Studio 연동:** 로컬 머신에서 실행 중인 LM Studio API (`http://127.0.0.1:1234/v1/chat/completions`)와 통신하여 모델 응답을 가져옵니다.
*   **대화 기록 관리:** Streamlit의 세션 상태(`st.session_state`)를 사용하여 현재 세션의 대화 기록을 유지합니다.
*   **스트리밍 응답:** 모델의 응답을 실시간으로 받아와 사용자에게 점진적으로 표시합니다 (`stream=True`). 이를 통해 사용자는 응답이 생성되는 과정을 볼 수 있습니다.
*   **생각/답변 분리 및 접기:** 모델 응답 내 `<think>...</think>` 태그로 감싸진 부분을 별도의 접을 수 있는 섹션으로 표시합니다. 이를 통해 모델의 "생각" 과정을 확인하거나 숨길 수 있습니다.
*   **영어 응답 강제:** 시스템 프롬프트를 통해 챗봇이 항상 영어로 답변하도록 설정되어 있습니다.
*   **LaTeX 수식 렌더링:** 모델 응답에 포함된 LaTeX 수식을 자동으로 감지하고 `st.latex()`를 사용하여 수식을 아름답게 렌더링합니다. 인라인 수식(`$...$`)과 디스플레이 수식(`$$...$$`)을 모두 지원합니다.
*   **메시지 추적 시스템:** 각 메시지에 고유 ID를 부여하고 응답-질문 관계를 추적하여 챗봇이 항상 최신 질문에 정확히 응답하도록 합니다.
*   **시간 기반 컨텍스트 관리:** 질문 간 시간 간격이 길면(5분 이상) 대화 컨텍스트를 자동으로 초기화하여 항상 최신 질문에 집중하도록 합니다.

## 최근 업데이트 (2025-05-06)

* **LaTeX 수식 렌더링 기능 개선:** 
  * 모델 응답에 포함된 LaTeX 수식을 자동으로 감지하고 적절히 렌더링하는 기능 추가
  * 수식과 일반 텍스트를 분리하여 각각 최적의 방식으로 렌더링
  * 분수(`\frac{}{}`), 괄호(`\left(`, `\right)`), 박스(`\boxed{}`) 등 다양한 수식 표현 지원
  * 인라인 수식(`$...$`)과 디스플레이 수식(`$$...$$`) 모두 지원

* **메시지 처리 시스템 개선:**
  * 각 메시지에 고유 ID 부여 시스템 추가
  * 응답 메시지가 어떤 사용자 메시지에 대한 응답인지 추적하는 기능 구현
  * 시스템 프롬프트 개선으로 모델이 항상 최신 질문에 집중하도록 유도
  * 이전 질문의 답변을 반복하는 문제 해결

* **강화된 컨텍스트 관리 (2025-05-06 추가):**
  * 시스템 프롬프트를 강화하여 모델이 항상 최신 질문에만 집중하도록 명확한 지시 추가
  * 각 API 요청마다 현재 질문을 강조하는 특별 시스템 메시지 추가
  * 질문 간 시간 간격이 5분 이상이면 대화 컨텍스트 자동 초기화
  * 메시지에 타임스탬프 추가로 정확한 시간 추적

## 실행 방법

1.  **LM Studio 실행:** 로컬 머신에서 LM Studio를 실행하고 `mimo-7b-rl` 모델을 로드한 후 API 서버를 시작합니다.
2.  **필요 라이브러리 설치:**
    ```bash
    pip install streamlit requests
    ```
3.  **Streamlit 앱 실행:**
    ```bash
    streamlit run app.py
    ```

이제 웹 브라우저에서 Streamlit 앱에 접속하여 챗봇과 대화할 수 있습니다.
